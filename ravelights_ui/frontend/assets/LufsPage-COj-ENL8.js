import{c as _,a as l,u as m}from"./uPlot.min-BaF0gXfa.js";import{v as p,r as g,G as v,t as b,w as k,z as x,A as I}from"./index-CCL2DMgm.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E="/rest/audio",y=1500,c=50,z=p({__name:"LufsPage",setup(R){const s=[[],[],[]],o=g(null);let t=null,n=null;const d=(e,a)=>({id:"lufs-chart",class:"lufs-chart",width:e,height:a,ms:1,pxAlign:!1,series:[{label:"time"},{label:"rms",stroke:l[0],width:2,scale:"db",value:(w,r)=>r+" dB"},{label:"lufs",stroke:l[1],width:2,scale:"db",value:(w,r)=>r+" LUFS"}],scales:{x:{time:!0},db:{auto:!0}},axes:[{stroke:"#aab1bf",grid:{width:1/devicePixelRatio,stroke:"#596170"}},{scale:"db",stroke:"#aab1bf",grid:{width:1/devicePixelRatio,stroke:"#596170"},label:"level (dB)"}],legend:{show:!0,live:!1},cursor:{show:!0,drag:{x:!1,y:!1},lock:!1}});async function i(){try{const e=await fetch(E);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const a=await e.json();s[0]=a.time_unix||[],s[1]=a.rms_db||[],s[2]=a.lufs||[],t&&t.setData(s)}catch(e){console.error("Error fetching data:",e)}}function u(){t&&t.setSize({width:window.innerWidth,height:window.innerHeight-c})}v(()=>{if(o.value){const e=window.innerWidth,a=window.innerHeight-c;t=new _(d(e,a),s,o.value),i(),n=window.setInterval(()=>{i()},y)}}),b(()=>{n&&clearInterval(n),t&&(t.destroy(),t=null)});const{width:f,height:h}=m();return k([f,h],()=>{u()}),(e,a)=>(I(),x("div",{ref_key:"chartContainer",ref:o,id:"chart-container"},null,512))}}),C=P(z,[["__scopeId","data-v-e4092869"]]);export{C as default};
