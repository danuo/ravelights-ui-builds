import{u as j,a as q,c as G,b as x,k as Q}from"./use-slider-CmuCgM4u.js";import{c as z,g as H,d as o,r as d,w as W,ab as J,f as U}from"./index-yLMKGSkL.js";const s={MIN:0,RANGE:1,MAX:2},_=z({name:"QRange",props:{...q,modelValue:{type:Object,default:()=>({min:null,max:null}),validator:e=>"min"in e&&"max"in e},dragRange:Boolean,dragOnlyRange:Boolean,leftLabelColor:String,leftLabelTextColor:String,rightLabelColor:String,rightLabelTextColor:String,leftLabelValue:[String,Number],rightLabelValue:[String,Number],leftThumbColor:String,rightThumbColor:String},emits:j,setup(e,{emit:g}){const{proxy:{$q:M}}=H(),{state:a,methods:m}=G({updateValue:N,updatePosition:X,getDragging:P,formAttrs:o(()=>({type:"hidden",name:e.name,value:`${e.modelValue.min}|${e.modelValue.max}`}))}),V=d(null),b=d(0),R=d(0),l=d({min:0,max:0});function y(){l.value.min=e.modelValue.min===null?a.innerMin.value:x(e.modelValue.min,a.innerMin.value,a.innerMax.value),l.value.max=e.modelValue.max===null?a.innerMax.value:x(e.modelValue.max,a.innerMin.value,a.innerMax.value)}W(()=>`${e.modelValue.min}|${e.modelValue.max}|${a.innerMin.value}|${a.innerMax.value}`,y),y();const T=o(()=>m.convertModelToRatio(l.value.min)),k=o(()=>m.convertModelToRatio(l.value.max)),h=o(()=>a.active.value===!0?b.value:T.value),L=o(()=>a.active.value===!0?R.value:k.value),w=o(()=>{const t={[a.positionProp.value]:`${100*h.value}%`,[a.sizeProp.value]:`${100*(L.value-h.value)}%`};return e.selectionImg!==void 0&&(t.backgroundImage=`url(${e.selectionImg}) !important`),t}),F=o(()=>{if(a.editable.value!==!0)return{};if(M.platform.is.mobile===!0)return{onClick:m.onMobileClick};const t={onMousedown:m.onActivate};return(e.dragRange===!0||e.dragOnlyRange===!0)&&Object.assign(t,{onFocus:()=>{a.focus.value="both"},onBlur:m.onBlur,onKeydown:A,onKeyup:m.onKeyup}),t});function S(t){return M.platform.is.mobile!==!0&&a.editable.value===!0&&e.dragOnlyRange!==!0?{onFocus:()=>{a.focus.value=t},onBlur:m.onBlur,onKeydown:A,onKeyup:m.onKeyup}:{}}const O=o(()=>e.dragOnlyRange!==!0?a.tabindex.value:null),B=o(()=>M.platform.is.mobile!==!0&&(e.dragRange||e.dragOnlyRange===!0)?a.tabindex.value:null),C=d(null),E=o(()=>S("min")),I=m.getThumbRenderFn({focusValue:"min",getNodeData:()=>({ref:C,key:"tmin",...E.value,tabindex:O.value}),ratio:h,label:o(()=>e.leftLabelValue!==void 0?e.leftLabelValue:l.value.min),thumbColor:o(()=>e.leftThumbColor||e.thumbColor||e.color),labelColor:o(()=>e.leftLabelColor||e.labelColor),labelTextColor:o(()=>e.leftLabelTextColor||e.labelTextColor)}),D=o(()=>S("max")),K=m.getThumbRenderFn({focusValue:"max",getNodeData:()=>({...D.value,key:"tmax",tabindex:O.value}),ratio:L,label:o(()=>e.rightLabelValue!==void 0?e.rightLabelValue:l.value.max),thumbColor:o(()=>e.rightThumbColor||e.thumbColor||e.color),labelColor:o(()=>e.rightLabelColor||e.labelColor),labelTextColor:o(()=>e.rightLabelTextColor||e.labelTextColor)});function N(t){(l.value.min!==e.modelValue.min||l.value.max!==e.modelValue.max)&&g("update:modelValue",{...l.value}),t===!0&&g("change",{...l.value})}function P(t){const{left:n,top:r,width:u,height:v}=V.value.getBoundingClientRect(),f=e.dragOnlyRange===!0?0:e.vertical===!0?C.value.offsetHeight/(2*v):C.value.offsetWidth/(2*u),i={left:n,top:r,width:u,height:v,valueMin:l.value.min,valueMax:l.value.max,ratioMin:T.value,ratioMax:k.value},c=m.getDraggingRatio(t,i);return e.dragOnlyRange!==!0&&c<i.ratioMin+f?i.type=s.MIN:e.dragOnlyRange===!0||c<i.ratioMax-f?e.dragRange===!0||e.dragOnlyRange===!0?(i.type=s.RANGE,Object.assign(i,{offsetRatio:c,offsetModel:m.convertRatioToModel(c),rangeValue:i.valueMax-i.valueMin,rangeRatio:i.ratioMax-i.ratioMin})):i.type=i.ratioMax-c<c-i.ratioMin?s.MAX:s.MIN:i.type=s.MAX,i}function X(t,n=a.dragging.value){let r;const u=m.getDraggingRatio(t,n),v=m.convertRatioToModel(u);switch(n.type){case s.MIN:u<=n.ratioMax?(r={minR:u,maxR:n.ratioMax,min:v,max:n.valueMax},a.focus.value="min"):(r={minR:n.ratioMax,maxR:u,min:n.valueMax,max:v},a.focus.value="max");break;case s.MAX:u>=n.ratioMin?(r={minR:n.ratioMin,maxR:u,min:n.valueMin,max:v},a.focus.value="max"):(r={minR:u,maxR:n.ratioMin,min:v,max:n.valueMin},a.focus.value="min");break;case s.RANGE:const f=u-n.offsetRatio,i=x(n.ratioMin+f,a.innerMinRatio.value,a.innerMaxRatio.value-n.rangeRatio),c=v-n.offsetModel,$=x(n.valueMin+c,a.innerMin.value,a.innerMax.value-n.rangeValue);r={minR:i,maxR:i+n.rangeRatio,min:a.roundValueFn.value($),max:a.roundValueFn.value($+n.rangeValue)},a.focus.value="both";break}l.value=l.value.min===null||l.value.max===null?{min:r.min||e.min,max:r.max||e.max}:{min:r.min,max:r.max},e.snap!==!0||e.step===0?(b.value=r.minR,R.value=r.maxR):(b.value=m.convertModelToRatio(l.value.min),R.value=m.convertModelToRatio(l.value.max))}function A(t){if(Q.includes(t.keyCode)===!1)return;J(t);const n=([34,33].includes(t.keyCode)?10:1)*a.keyStep.value,r=([34,37,40].includes(t.keyCode)?-1:1)*(a.isReversed.value===!0?-1:1)*(e.vertical===!0?-1:1)*n;if(a.focus.value==="both"){const u=l.value.max-l.value.min,v=x(a.roundValueFn.value(l.value.min+r),a.innerMin.value,a.innerMax.value-u);l.value={min:v,max:a.roundValueFn.value(v+u)}}else{if(a.focus.value===!1)return;{const u=a.focus.value;l.value={...l.value,[u]:x(a.roundValueFn.value(l.value[u]+r),u==="min"?a.innerMin.value:l.value.min,u==="max"?a.innerMax.value:l.value.max)}}}N()}return()=>{const t=m.getContent(w,B,F,n=>{n.push(I(),K())});return U("div",{ref:V,class:"q-range "+a.classes.value+(e.modelValue.min===null||e.modelValue.max===null?" q-slider--no-value":""),...a.attributes.value,"aria-valuenow":e.modelValue.min+"|"+e.modelValue.max},t)}}});export{_ as Q};
