import{Q as K}from"./QPage-BOJ-IRJJ.js";import{Q as H}from"./QInput-D04WBjLc.js";import{x,y as b,d as W,z as h,A as o,D as q,K as r,E as a,B as n,Q as A,L as g,a1 as E,C as y,P as $,M as k,a3 as Y,a4 as J,r as V,w,a5 as I,a6 as T,p as U,F as X}from"./index-hWWSojUG.js";import{Q as Z}from"./QSlider-CNbxlwa4.js";import{Q as F}from"./QList-DPG5whr4.js";import{U as C}from"./UniversalControlComponent-cZh8-lso.js";import{u as Q}from"./app-store-DqvHmd1p.js";import{u as O,i as G,a as L,b as M,c as N,s as P,T as j}from"./installCanvasRenderer-toCmttdy.js";import{F as B}from"./FancyToggleComponent-BlCDmC-I.js";import"./use-key-composition-BiuFw4Y6.js";import"./selection-C9__sGYQ.js";import"./QItemLabel-DT4T4jBh.js";import"./QToggle-D3GnJlNQ.js";import"./option-sizes-sVLocBWt.js";import"./QItemSection-bpkiDmXT.js";import"./QSelect-Crz_6U_7.js";import"./QChip-CnkDU2K2.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const D={key:0,class:"q-mt-xs q-col-gutter-xs bpm-custom-styles"},ee={class:"row"},te={class:"col-6",id:"bpm_input"},se={class:"col-3"},ae={class:"col-3"},oe={class:"row"},ne={class:"col-6"},ie={class:"col-3"},le={class:"col-3"},re={class:"q-px-none q-mt-lg q-mb-md"},ue={class:"row flex-center",style:{width:"100%"}},ce={__name:"BpmComponent",setup(v){const s=x(),{settings:t}=b(s),_={0:"1/2",1:1,2:2},u=W({get(){return t.value.bpm_multiplier==.5?0:t.value.bpm_multiplier},set(m){t.value.bpm_multiplier=m==0?.5:m}});function i(){E("/rest/settings",{action:"set_sync"})}function c(m){E("/rest/settings",{action:"adjust_sync",value:m})}function p(m){t.value.bpm_base=parseFloat((t.value.bpm_base+m).toFixed(2)),s.set_settings("bpm_base")}return(m,e)=>(o(),h(g,null,[Object.keys(a(t)).length>0?(o(),h("div",D,[r("div",ee,[r("div",te,[n(H,{modelValue:a(t).bpm_base,"onUpdate:modelValue":e[0]||(e[0]=d=>a(t).bpm_base=d),modelModifiers:{number:!0},outlined:""},null,8,["modelValue"])]),r("div",se,[n(A,{onClick:e[1]||(e[1]=d=>p(.1)),square:!0,color:"primary",icon:"expand_less",size:"20px"})]),r("div",ae,[n(A,{onClick:e[2]||(e[2]=d=>p(-.1)),color:"primary",icon:"expand_more",size:"20px"})])]),r("div",oe,[r("div",ne,[n(A,{onClick:e[3]||(e[3]=d=>i()),label:"sync",color:"primary",size:"20px"})]),r("div",ie,[n(A,{onClick:e[4]||(e[4]=d=>c(.1)),color:"primary",icon:"navigate_before",size:"20px"})]),r("div",le,[n(A,{onClick:e[5]||(e[5]=d=>c(-.1)),color:"primary",icon:"navigate_next",size:"20px"})])])])):q("",!0),r("div",re,[e[8]||(e[8]=r("div",{style:{"padding-left":"16px"},class:"text-caption"},"bpm multiplier",-1)),r("div",ue,[n(Z,{onChange:e[6]||(e[6]=d=>a(s).set_settings("bpm_multiplier")),modelValue:u.value,"onUpdate:modelValue":e[7]||(e[7]=d=>u.value=d),color:"secondary","selection-color":"secondary","track-size":"15px","thumb-size":"30px",min:0,max:2,"marker-labels":_,snap:"",style:{width:"66%"}},null,8,["modelValue"])])])],64))}},de={__name:"GeneralSettingsComponent",setup(v){const s=x();return(t,_)=>(o(),y(F,{bordered:"",separator:""},{default:$(()=>[(o(!0),h(g,null,k(a(s).meta.controls_global_sliders,u=>(o(),y(C,{key:u.label,button:u},null,8,["button"]))),128))]),_:1}))}},pe=1500,R=Y("audio-store",{state:()=>({data:null,subscribers:0}),actions:{async fetchData(){console.log("fetching data"),this.data=await J("/rest/audio")},startFetching(){this.subscribers>0&&!this._interval&&(this.fetchData(),this._interval=setInterval(this.fetchData,pe))},stopFetching(){this.subscribers===0&&this._interval&&(clearInterval(this._interval),this._interval=null)},subscribe(){return console.log("subscribed"),this.subscribers++,this.startFetching(),()=>{this.subscribers--,this.stopFetching()}}}}),me={__name:"AudioEnergyChart",setup(v){U(j,"dark"),O([G,L,M,N]);const s=V(null),t=V(!1),_=x(),{settings:u}=b(_),i=Q(),{enable_charts:c}=b(i),p=R(),{data:m}=b(p);let e=null;const d={xAxis:{type:"category",data:[]},yAxis:{type:"value",min:0,max:1},legend:{textStyle:{fontSize:18},top:20,selected:{mapped:!0,max:!1,min:!1,mean:!1}},series:[{name:"mapped",showSymbol:!1,data:[],type:"line",emphasis:{disabled:!0}},{name:"max",showSymbol:!1,data:[],type:"line",emphasis:{disabled:!0}},{name:"min",showSymbol:!1,data:[],type:"line",emphasis:{disabled:!0}},{name:"mean",showSymbol:!1,data:[],type:"line",emphasis:{disabled:!0}}]};w(m,l=>{if(!s.value)return;const f={xAxis:{data:l.time},series:[{data:l.mapped},{data:l.max},{data:l.min},{data:l.mean}]};s.value.setOption(f)}),I(()=>{console.log("activated"),t.value=!0}),T(()=>{console.log("deactivated"),t.value=!1}),w([t,c,u],([l,f,z])=>{l&&f&&!z.performance_mode?(S(),e=p.subscribe()):S()});function S(){e&&(e(),e=null)}return(l,f)=>a(c)?(o(),y(a(P),{key:0,ref_key:"echartAudio",ref:s,"manual-update":"",option:d,style:{height:"500px"}},null,512)):q("",!0)}},_e={__name:"AudioGainChart",setup(v){U(j,"dark"),O([G,L,M,N]);const s=V(null),t=V(!1),_=x(),{settings:u}=b(_),i=Q(),{enable_charts:c}=b(i),p=R(),{data:m}=b(p);let e=null;const d={xAxis:{type:"category",data:[]},yAxis:{type:"value",min:0,max:1},legend:{textStyle:{fontSize:18},top:20},series:[{name:"rms",showSymbol:!1,data:[],type:"line",emphasis:{disabled:!0}},{name:"signal_max",showSymbol:!1,data:[],type:"line",emphasis:{disabled:!0}}]};w(m,l=>{if(!s.value)return;const f={xAxis:{data:l.time},series:[{data:l.rms},{data:l.signal_max}]};s.value.setOption(f)}),I(()=>{console.log("activated AudioGainChart"),t.value=!0}),T(()=>{console.log("deactivated AudioGainChart"),t.value=!1}),w([t,c,u],([l,f,z])=>{l&&f&&!z.performance_mode?(S(),e=p.subscribe()):S()});function S(){e&&(e(),e=null)}return(l,f)=>a(c)?(o(),y(a(P),{key:0,ref_key:"echartAudio",ref:s,"manual-update":"",option:d,style:{height:"500px"}},null,512)):q("",!0)}},be={__name:"AudioSettingsComponent",setup(v){const s=x(),{settings:t}=b(s);return(_,u)=>(o(),h(g,null,[n(F,{bordered:"",separator:"",class:"q-my-md"},{default:$(()=>[n(_e),(o(!0),h(g,null,k(a(s).meta.controls_audio.main,i=>(o(),y(C,{key:i.label,button:i},null,8,["button"]))),128)),(o(!0),h(g,null,k(a(s).meta.controls_audio[a(t).audio_fade_mode],i=>(o(),y(C,{key:i.label,button:i},null,8,["button"]))),128)),a(t).audio_fade_mode=="audio"?(o(),y(me,{key:0})):q("",!0)]),_:1}),n(F,{bordered:"",separator:"",class:"q-my-md"},{default:$(()=>[(o(!0),h(g,null,k(a(s).meta.controls_audio.blackout,i=>(o(),y(C,{key:i.label,button:i},null,8,["button"]))),128))]),_:1})],64))}},fe={class:"row q-col-gutter-sm q-pb-md"},ye={class:"col-6"},he={class:"col-6"},ve={__name:"AudioControlsWrapper",setup(v){const s=x(),t=Q(),{enable_charts:_}=b(t),{settings:u}=b(s);return(i,c)=>(o(),h(g,null,[r("div",fe,[r("div",ye,[n(B,{modelValue:a(u).enable_audio_analysis,"onUpdate:modelValue":c[0]||(c[0]=p=>a(u).enable_audio_analysis=p),callback:()=>a(s).set_settings("enable_audio_analysis"),label:"Audio Analysis",icon:"mic",muted:"",fancy:""},null,8,["modelValue","callback"])]),r("div",he,[n(B,{modelValue:a(_),"onUpdate:modelValue":c[1]||(c[1]=p=>X(_)?_.value=p:null),label:"Show Charts",icon:"show_chart",fancy:"",muted:""},null,8,["modelValue"])])]),n(be)],64))}},Oe={__name:"AudioPage",setup(v){return(s,t)=>(o(),y(K,{padding:""},{default:$(()=>[n(ce),n(ve),n(de)]),_:1}))}};export{Oe as default};
