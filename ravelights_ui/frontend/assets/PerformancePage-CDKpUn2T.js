import{Q as w}from"./QPage-BOJ-IRJJ.js";import{r as c,x,y as C,a5 as P,a6 as k,aK as A,z as d,A as n,K as s,D as V,B as i,E as l,L as _,a2 as I,a4 as D,p as E,M as $,C as g,P as q}from"./index-hWWSojUG.js";import{F as h}from"./FancyToggleComponent-BlCDmC-I.js";import{u as B,s as M,i as F,a as T,b as U,c as K,T as N}from"./installCanvasRenderer-toCmttdy.js";import{U as z}from"./UniversalControlComponent-cZh8-lso.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QItemLabel-DT4T4jBh.js";import"./QToggle-D3GnJlNQ.js";import"./option-sizes-sVLocBWt.js";import"./selection-C9__sGYQ.js";import"./QItemSection-bpkiDmXT.js";import"./QSlider-CNbxlwa4.js";import"./QSelect-Crz_6U_7.js";import"./use-key-composition-BiuFw4Y6.js";import"./QChip-CnkDU2K2.js";const O={class:"row q-col-gutter-sm q-pb-sm"},Q={class:"col-6"},H={class:"col-6"},R={class:"q-py-lg"},Y={class:"row items-center"},j={class:"col-6"},G={__name:"PerformanceChartComponent",setup(y){E(N,"dark"),B([F,T,U,K]);const o=c(null),e=c(!1),m=c(!1),r=x(),{settings:p}=C(r),v=c(0);let f;const b={xAxis:{type:"category",data:[]},yAxis:[{type:"value",name:"[f/s]",min:0},{type:"value",name:"[s]",max:.05,min:0}],legend:{textStyle:{fontSize:18},top:20,selected:{mapped:!0,max:!1,min:!1,mean:!1}},series:[{name:"fps",showSymbol:!1,data:[],type:"line",emphasis:{disabled:!0}},{name:"cap",showSymbol:!1,data:[],type:"line",emphasis:{disabled:!0}},{name:"render time",showSymbol:!1,data:[],type:"line",emphasis:{disabled:!0},lineStyle:{type:"dashed"},yAxisIndex:1},{name:"sleep time",showSymbol:!1,data:[],type:"line",emphasis:{disabled:!0},lineStyle:{type:"dashed"},yAxisIndex:1}]};async function S(){if(!o.value)return;const a=await D("/rest/performance"),t={xAxis:{data:a.time},yAxis:[{max:Math.round(Math.max(...a.fps_cap))},{}],series:[{data:a.fps},{data:a.fps_cap},{data:a.render_time},{data:a.sleep_time}]};o.value.setOption(t),v.value=a.delayed_frames.slice(-1)[0]}return P(()=>{console.log("activated"),m.value=!0}),k(()=>{console.log("deactivated"),m.value=!1}),A(()=>{m.value&&e.value&&!p.value.performance_mode?(clearInterval(f),f=setInterval(S,1e3)):clearInterval(f)}),(a,t)=>(n(),d(_,null,[s("div",O,[s("div",Q,[i(h,{modelValue:l(p).performance_mode,"onUpdate:modelValue":t[0]||(t[0]=u=>l(p).performance_mode=u),callback:()=>l(r).set_settings("performance_mode"),label:"Performance Mode",icon:"rocket_launch",fancy:"",muted:""},null,8,["modelValue","callback"])]),s("div",H,[i(h,{modelValue:e.value,"onUpdate:modelValue":t[1]||(t[1]=u=>e.value=u),label:"Show Stats",icon:"show_chart",fancy:"",muted:""},null,8,["modelValue"])])]),e.value?(n(),d(_,{key:0},[i(l(M),{ref_key:"echartPerformance",ref:o,"manual-update":"",option:b,style:{height:"500px"}},null,512),s("div",R,[s("div",Y,[t[2]||(t[2]=s("div",{class:"col-6"},"Delayed Frames:",-1)),s("div",j,I(v.value),1)])])],64)):V("",!0)],64))}},J={class:"fancy-grid"},W={__name:"PerformanceControlsComponent",setup(y){const o=x();return(e,m)=>(n(),d("div",J,[(n(!0),d(_,null,$(l(o).meta.controls_performance,r=>(n(),g(z,{key:r.label,button:r},null,8,["button"]))),128))]))}},X=L(W,[["__scopeId","data-v-fb82b2f5"]]),ue={__name:"PerformancePage",setup(y){return(o,e)=>(n(),g(w,{padding:""},{default:q(()=>[e[0]||(e[0]=s("div",{class:"text-caption q-pt-md q-px-sm"},"Performance Settings",-1)),i(G),i(X)]),_:1}))}};export{ue as default};
