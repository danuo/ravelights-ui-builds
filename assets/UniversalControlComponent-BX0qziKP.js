import{Q as w,a as S}from"./QItemLabel-BjeMTmEL.js";import{Q as K}from"./QToggle-D0YfChf3.js";import{Q as p}from"./QItemSection-BVGERZu3.js";import{u as ee,a as ae,c as le,b as h,k as te,Q}from"./QSlider-BY_pducC.js";import{c as ne,g as oe,d as m,r as F,w as ue,ad as ie,f as re,x as me,y as se,z as ve,A as V,C as k,D as T,P as x,B as c,K as f,a8 as L,a2 as N,E as de,L as be}from"./index-C7l3P4d2.js";import{Q as ce}from"./QSelect-CGwSs9g3.js";import{F as xe}from"./FancyToggleComponent-DDkPHmPS.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={MIN:0,RANGE:1,MAX:2},ge=ne({name:"QRange",props:{...ae,modelValue:{type:Object,default:()=>({min:null,max:null}),validator:a=>"min"in a&&"max"in a},dragRange:Boolean,dragOnlyRange:Boolean,leftLabelColor:String,leftLabelTextColor:String,rightLabelColor:String,rightLabelTextColor:String,leftLabelValue:[String,Number],rightLabelValue:[String,Number],leftThumbColor:String,rightThumbColor:String},emits:ee,setup(a,{emit:e}){const{proxy:{$q:C}}=oe(),{state:l,methods:s}=le({updateValue:$,updatePosition:Z,getDragging:Y,formAttrs:m(()=>({type:"hidden",name:a.name,value:`${a.modelValue.min}|${a.modelValue.max}`}))}),i=F(null),M=F(0),g=F(0),n=F({min:0,max:0});function t(){n.value.min=a.modelValue.min===null?l.innerMin.value:h(a.modelValue.min,l.innerMin.value,l.innerMax.value),n.value.max=a.modelValue.max===null?l.innerMax.value:h(a.modelValue.max,l.innerMin.value,l.innerMax.value)}ue(()=>`${a.modelValue.min}|${a.modelValue.max}|${l.innerMin.value}|${l.innerMax.value}`,t),t();const o=m(()=>s.convertModelToRatio(n.value.min)),I=m(()=>s.convertModelToRatio(n.value.max)),B=m(()=>l.active.value===!0?M.value:o.value),A=m(()=>l.active.value===!0?g.value:I.value),P=m(()=>{const r={[l.positionProp.value]:`${100*B.value}%`,[l.sizeProp.value]:`${100*(A.value-B.value)}%`};return a.selectionImg!==void 0&&(r.backgroundImage=`url(${a.selectionImg}) !important`),r}),j=m(()=>{if(l.editable.value!==!0)return{};if(C.platform.is.mobile===!0)return{onClick:s.onMobileClick};const r={onMousedown:s.onActivate};return(a.dragRange===!0||a.dragOnlyRange===!0)&&Object.assign(r,{onFocus:()=>{l.focus.value="both"},onBlur:s.onBlur,onKeydown:q,onKeyup:s.onKeyup}),r});function U(r){return C.platform.is.mobile!==!0&&l.editable.value===!0&&a.dragOnlyRange!==!0?{onFocus:()=>{l.focus.value=r},onBlur:s.onBlur,onKeydown:q,onKeyup:s.onKeyup}:{}}const E=m(()=>a.dragOnlyRange!==!0?l.tabindex.value:null),X=m(()=>C.platform.is.mobile!==!0&&(a.dragRange||a.dragOnlyRange===!0)?l.tabindex.value:null),O=F(null),G=m(()=>U("min")),H=s.getThumbRenderFn({focusValue:"min",getNodeData:()=>({ref:O,key:"tmin",...G.value,tabindex:E.value}),ratio:B,label:m(()=>a.leftLabelValue!==void 0?a.leftLabelValue:n.value.min),thumbColor:m(()=>a.leftThumbColor||a.thumbColor||a.color),labelColor:m(()=>a.leftLabelColor||a.labelColor),labelTextColor:m(()=>a.leftLabelTextColor||a.labelTextColor)}),W=m(()=>U("max")),J=s.getThumbRenderFn({focusValue:"max",getNodeData:()=>({...W.value,key:"tmax",tabindex:E.value}),ratio:A,label:m(()=>a.rightLabelValue!==void 0?a.rightLabelValue:n.value.max),thumbColor:m(()=>a.rightThumbColor||a.thumbColor||a.color),labelColor:m(()=>a.rightLabelColor||a.labelColor),labelTextColor:m(()=>a.rightLabelTextColor||a.labelTextColor)});function $(r){(n.value.min!==a.modelValue.min||n.value.max!==a.modelValue.max)&&e("update:modelValue",{...n.value}),r===!0&&e("change",{...n.value})}function Y(r){const{left:u,top:b,width:v,height:_}=i.value.getBoundingClientRect(),z=a.dragOnlyRange===!0?0:a.vertical===!0?O.value.offsetHeight/(2*_):O.value.offsetWidth/(2*v),d={left:u,top:b,width:v,height:_,valueMin:n.value.min,valueMax:n.value.max,ratioMin:o.value,ratioMax:I.value},y=s.getDraggingRatio(r,d);return a.dragOnlyRange!==!0&&y<d.ratioMin+z?d.type=R.MIN:a.dragOnlyRange===!0||y<d.ratioMax-z?a.dragRange===!0||a.dragOnlyRange===!0?(d.type=R.RANGE,Object.assign(d,{offsetRatio:y,offsetModel:s.convertRatioToModel(y),rangeValue:d.valueMax-d.valueMin,rangeRatio:d.ratioMax-d.ratioMin})):d.type=d.ratioMax-y<y-d.ratioMin?R.MAX:R.MIN:d.type=R.MAX,d}function Z(r,u=l.dragging.value){let b;const v=s.getDraggingRatio(r,u),_=s.convertRatioToModel(v);switch(u.type){case R.MIN:v<=u.ratioMax?(b={minR:v,maxR:u.ratioMax,min:_,max:u.valueMax},l.focus.value="min"):(b={minR:u.ratioMax,maxR:v,min:u.valueMax,max:_},l.focus.value="max");break;case R.MAX:v>=u.ratioMin?(b={minR:u.ratioMin,maxR:v,min:u.valueMin,max:_},l.focus.value="max"):(b={minR:v,maxR:u.ratioMin,min:_,max:u.valueMin},l.focus.value="min");break;case R.RANGE:const z=v-u.offsetRatio,d=h(u.ratioMin+z,l.innerMinRatio.value,l.innerMaxRatio.value-u.rangeRatio),y=_-u.offsetModel,D=h(u.valueMin+y,l.innerMin.value,l.innerMax.value-u.rangeValue);b={minR:d,maxR:d+u.rangeRatio,min:l.roundValueFn.value(D),max:l.roundValueFn.value(D+u.rangeValue)},l.focus.value="both";break}n.value=n.value.min===null||n.value.max===null?{min:b.min||a.min,max:b.max||a.max}:{min:b.min,max:b.max},a.snap!==!0||a.step===0?(M.value=b.minR,g.value=b.maxR):(M.value=s.convertModelToRatio(n.value.min),g.value=s.convertModelToRatio(n.value.max))}function q(r){if(te.includes(r.keyCode)===!1)return;ie(r);const u=([34,33].includes(r.keyCode)?10:1)*l.keyStep.value,b=([34,37,40].includes(r.keyCode)?-1:1)*(l.isReversed.value===!0?-1:1)*(a.vertical===!0?-1:1)*u;if(l.focus.value==="both"){const v=n.value.max-n.value.min,_=h(l.roundValueFn.value(n.value.min+b),l.innerMin.value,l.innerMax.value-v);n.value={min:_,max:l.roundValueFn.value(_+v)}}else{if(l.focus.value===!1)return;{const v=l.focus.value;n.value={...n.value,[v]:h(l.roundValueFn.value(n.value[v]+b),v==="min"?l.innerMin.value:n.value.min,v==="max"?l.innerMax.value:n.value.max)}}}$()}return()=>{const r=s.getContent(P,X,j,u=>{u.push(H(),J())});return re("div",{ref:i,class:"q-range "+l.classes.value+(a.modelValue.min===null||a.modelValue.max===null?" q-slider--no-value":""),...l.attributes.value,"aria-valuenow":a.modelValue.min+"|"+a.modelValue.max},r)}}}),_e={class:"row q-pa-md"},Me={class:"col-3"},ye={class:"row q-pa-md"},Ve={class:"col-3"},Re={class:"col-9"},Ce={class:"row q-pa-md"},ke={class:"col-12"},Te={class:"row q-pa-md"},he={class:"col-12"},we={class:"row q-pa-md"},Se={class:"col-9"},pe={__name:"UniversalControlComponent",props:{button:Object,labelFn:Function,deviceIndex:Number},setup(a){const e=a,C=me(),{settings:l,devices:s}=se(C),i=m(()=>e.button.target=="device"?s[deviceIndex]:l);function M(n){return e.labelFn?e.labelFn(n):n}function g(n,t){e.button.target!="device"&&C.set_settings_value(n,t)}return(n,t)=>(V(),ve(be,null,[e.button.type=="toggle"?(V(),k(S,{key:0},{default:x(()=>[c(p,null,{default:x(()=>[c(w,{caption:""},{default:x(()=>[L(N(e.button.label),1)]),_:1}),f("div",_e,[f("div",Me,[c(K,{"onUpdate:modelValue":[t[0]||(t[0]=(o,I)=>g(e.button.var_name,o)),t[1]||(t[1]=o=>i.value.value[e.button.var_name]=o)],modelValue:i.value.value[e.button.var_name],size:"40px",color:"secondary"},null,8,["modelValue"])])])]),_:1})]),_:1})):T("",!0),e.button.type=="fancy_toggle"?(V(),k(xe,{key:1,modelValue:i.value.value[e.button.var_name],"onUpdate:modelValue":t[2]||(t[2]=o=>i.value.value[e.button.var_name]=o),callback:()=>de(C).set_settings(e.button.var_name),label:e.button.label,icon:e.button.icon,fancy:"",muted:""},null,8,["modelValue","callback","label","icon"])):T("",!0),e.button.type=="toggle_slider"?(V(),k(S,{key:2},{default:x(()=>[c(p,null,{default:x(()=>[c(w,{caption:""},{default:x(()=>[L(N(e.button.label),1)]),_:1}),f("div",ye,[f("div",Ve,[c(K,{"onUpdate:modelValue":[t[3]||(t[3]=(o,I)=>g(e.button.var_name_toggle,o)),t[4]||(t[4]=o=>i.value.value[e.button.var_name_toggle]=o)],modelValue:i.value.value[e.button.var_name_toggle],size:"40px",color:"secondary"},null,8,["modelValue"])]),f("div",Re,[c(Q,{onChange:t[5]||(t[5]=o=>g(e.button.var_name_slider,o)),modelValue:i.value.value[e.button.var_name_slider],"onUpdate:modelValue":t[6]||(t[6]=o=>i.value.value[e.button.var_name_slider]=o),color:"secondary","selection-color":"secondary","track-size":"14px","thumb-size":"26px",markers:e.button.markers,min:e.button.range_min,max:e.button.range_max,step:e.button.step,snap:"","label-always":"","label-value":M(i.value.value[e.button.var_name_slider])},null,8,["modelValue","markers","min","max","step","label-value"])])])]),_:1})]),_:1})):T("",!0),e.button.type=="slider"?(V(),k(S,{key:3},{default:x(()=>[c(p,null,{default:x(()=>[c(w,{caption:""},{default:x(()=>[L(N(e.button.var_name),1)]),_:1}),f("div",Ce,[f("div",ke,[c(Q,{onChange:t[7]||(t[7]=o=>g(e.button.var_name,o)),modelValue:i.value.value[e.button.var_name],"onUpdate:modelValue":t[8]||(t[8]=o=>i.value.value[e.button.var_name]=o),color:"secondary","selection-color":"secondary","track-size":"14px","thumb-size":"26px",markers:e.button.markers,min:e.button.range_min,max:e.button.range_max,step:e.button.step,snap:"","label-always":"","label-value":M(i.value.value[e.button.var_name]),"marker-labels":e.button.marker_labels||!1},null,8,["modelValue","markers","min","max","step","label-value","marker-labels"])])])]),_:1})]),_:1})):T("",!0),e.button.type=="range_slider"?(V(),k(S,{key:4},{default:x(()=>[c(p,null,{default:x(()=>[c(w,{caption:""},{default:x(()=>[L(N(e.button.var_name),1)]),_:1}),f("div",Te,[f("div",he,[c(ge,{onChange:t[9]||(t[9]=o=>g(e.button.var_name,o)),modelValue:i.value.value[e.button.var_name],"onUpdate:modelValue":t[10]||(t[10]=o=>i.value.value[e.button.var_name]=o),color:"secondary","selection-color":"secondary","track-size":"14px","thumb-size":"26px",markers:e.button.markers,min:e.button.range_min,max:e.button.range_max,step:e.button.step,snap:"","label-always":"","label-value":M(i.value.value[e.button.var_name])},null,8,["modelValue","markers","min","max","step","label-value"])])])]),_:1})]),_:1})):T("",!0),e.button.type=="padded_slider"?(V(),k(S,{key:5},{default:x(()=>[c(p,null,{default:x(()=>[c(w,{caption:""},{default:x(()=>[L(N(e.button.var_name),1)]),_:1}),f("div",we,[t[15]||(t[15]=f("div",{class:"col-3"},null,-1)),f("div",Se,[c(Q,{onChange:t[11]||(t[11]=o=>g(e.button.var_name,o)),modelValue:i.value.value[e.button.var_name],"onUpdate:modelValue":t[12]||(t[12]=o=>i.value.value[e.button.var_name]=o),color:"secondary","selection-color":"secondary","track-size":"14px","thumb-size":"26px",markers:e.button.markers,min:e.button.range_min,max:e.button.range_max,step:e.button.step,snap:"","label-always":"","label-value":M(i.value.value[e.button.var_name])},null,8,["modelValue","markers","min","max","step","label-value"])])])]),_:1})]),_:1})):T("",!0),e.button.type=="dropdown"?(V(),k(ce,{key:6,square:"",outlined:"","onUpdate:modelValue":[t[13]||(t[13]=o=>g(e.button.var_name,o)),t[14]||(t[14]=o=>i.value.value[e.button.var_name]=o)],modelValue:i.value.value[e.button.var_name],options:e.button.options,label:e.button.var_name,color:"secondary"},null,8,["modelValue","options","label"])):T("",!0)],64))}},Ae=fe(pe,[["__scopeId","data-v-9b0f9b2d"]]);export{Ae as U};
