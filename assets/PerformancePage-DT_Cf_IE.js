import{Q as P}from"./QPage-CRmDao5O.js";import{r as c,x as h,y as S,a5 as k,a6 as A,aK as w,z as d,A as n,K as s,D as V,B as i,E as l,L as _,a2 as E,a4 as I,p as D,M as $,C as g,P as q}from"./index-C7l3P4d2.js";import{F as x}from"./FancyToggleComponent-DDkPHmPS.js";import{u as B,E as M,i as F,a as T,b as U,c as K,T as N}from"./installCanvasRenderer-13x5j2v3.js";import{U as z}from"./UniversalControlComponent-BX0qziKP.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QItemLabel-BjeMTmEL.js";import"./QToggle-D0YfChf3.js";import"./option-sizes-D6HSlOre.js";import"./selection-8urfZMsW.js";import"./QItemSection-BVGERZu3.js";import"./QSlider-BY_pducC.js";import"./QSelect-CGwSs9g3.js";import"./use-key-composition-DlvROmZu.js";import"./QChip-Bw8N3IwS.js";const O={class:"row q-col-gutter-sm q-pb-sm"},Q={class:"col-6"},H={class:"col-6"},R={class:"q-py-lg"},Y={class:"row items-center"},j={class:"col-6"},G={__name:"PerformanceChartComponent",setup(v){D(N,"dark"),B([F,T,U,K]);const o=c(null),e=c(!1),m=c(!1),r=h(),{settings:p}=S(r),y=c(0);let f;const b={xAxis:{type:"category",data:[]},yAxis:[{type:"value",name:"[f/s]",min:0},{type:"value",name:"[s]",max:.05,min:0}],legend:{textStyle:{fontSize:18},top:20,selected:{mapped:!0,max:!1,min:!1,mean:!1}},series:[{name:"fps",data:[],type:"line",emphasis:{disabled:!0}},{name:"cap",data:[],type:"line",emphasis:{disabled:!0}},{name:"render time",data:[],type:"line",emphasis:{disabled:!0},lineStyle:{type:"dashed"},yAxisIndex:1},{name:"sleep time",data:[],type:"line",emphasis:{disabled:!0},lineStyle:{type:"dashed"},yAxisIndex:1}]};async function C(){if(!o.value)return;const a=await I("/rest/performance"),t={xAxis:{data:a.time},yAxis:[{max:Math.round(Math.max(...a.fps_cap))},{}],series:[{data:a.fps},{data:a.fps_cap},{data:a.render_time},{data:a.sleep_time}]};o.value.setOption(t),y.value=a.delayed_frames.slice(-1)[0]}return k(()=>{console.log("activated"),m.value=!0}),A(()=>{console.log("deactivated"),m.value=!1}),w(()=>{m.value&&e.value&&!p.value.performance_mode?(clearInterval(f),f=setInterval(C,1e3)):clearInterval(f)}),(a,t)=>(n(),d(_,null,[s("div",O,[s("div",Q,[i(x,{modelValue:l(p).performance_mode,"onUpdate:modelValue":t[0]||(t[0]=u=>l(p).performance_mode=u),callback:()=>l(r).set_settings("performance_mode"),label:"Performance Mode",icon:"rocket_launch",fancy:"",muted:""},null,8,["modelValue","callback"])]),s("div",H,[i(x,{modelValue:e.value,"onUpdate:modelValue":t[1]||(t[1]=u=>e.value=u),label:"Show Stats",icon:"show_chart",fancy:"",muted:""},null,8,["modelValue"])])]),e.value?(n(),d(_,{key:0},[i(l(M),{ref_key:"echartPerformance",ref:o,option:b,style:{height:"500px"}},null,512),s("div",R,[s("div",Y,[t[2]||(t[2]=s("div",{class:"col-6"},"Delayed Frames:",-1)),s("div",j,E(y.value),1)])])],64)):V("",!0)],64))}},J={class:"fancy-grid"},W={__name:"PerformanceControlsComponent",setup(v){const o=h();return(e,m)=>(n(),d("div",J,[(n(!0),d(_,null,$(l(o).meta.controls_performance,r=>(n(),g(z,{key:r.label,button:r},null,8,["button"]))),128))]))}},X=L(W,[["__scopeId","data-v-fb82b2f5"]]),ue={__name:"PerformancePage",setup(v){return(o,e)=>(n(),g(P,{padding:""},{default:q(()=>[e[0]||(e[0]=s("div",{class:"text-caption q-pt-md q-px-sm"},"Performance Settings",-1)),i(G),i(X)]),_:1}))}};export{ue as default};
